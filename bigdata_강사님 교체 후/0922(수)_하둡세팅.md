## 9/22(수)

#### 빅데이터 플랫폼 구축

--------

> 세팅

  **1. vmware 설치**  

  **2. vmware 가상머신 설치하기 - CentOS 7버전을 설치한다.**

  **3. 가상머신 복제하기**

​     **- 가상머신이 네 대 있다 가정하고 네 개의 가상머신을 만들어준다.**

​     **: ip확인**

  **4. 하둡 서버를 구축하기 위한 클러스터링 설정하기**

​     **- 방화벽해제**

​     **- 네트워크 설정**

​     **- DNS설정**

  **5. 각종 프로그램 설치**

​     **- SSH 프로토콜 설정**

​     **- hadoop을 테스트하기 위해서는 자바가 반드시 필요하므로**

​     **- java, hadoop을 설치하고 설정을 한 후 테스트한다.**

  **6. hadoop의 EchoSystem을 살펴보고 EchoSystem을 설치하여 테스트한다.** 



> 설치 시 에러가 나는 경우

- 체크 해제

![image-20200923090644779](C:\Users\whtpw\AppData\Roaming\Typora\typora-user-images\image-20200923090644779.png)



##### **2. vmware 가상머신 설치하기 - CentOS 7버전을 설치한다.**

> CentOS 7 설치하기

- hadoop01 실행

![image-20200923091514662](C:\Users\whtpw\AppData\Roaming\Typora\typora-user-images\image-20200923091514662.png)



- 설치 진행

![image-20200923091413884](C:\Users\whtpw\AppData\Roaming\Typora\typora-user-images\image-20200923091413884.png)



- Ctrl+Alt 안 눌러도 게스트와 호스트 간의 마우스를 자유롭게 이동할 수 있다. 
  - 한국어 선택 
  - **[계속 진행]** 버튼을 눌러 계속 설치

![image-20200923091712741](C:\Users\whtpw\AppData\Roaming\Typora\typora-user-images\image-20200923091712741.png)



- 날짜 시간 키보드 모두 한국어 선택

  - 키보드 선택

  ![image-20200923092037010](C:\Users\whtpw\AppData\Roaming\Typora\typora-user-images\image-20200923092037010.png)

  

  - +버튼 클릭 

  ![image-20200923092132488](C:\Users\whtpw\AppData\Roaming\Typora\typora-user-images\image-20200923092132488.png)

  

  - 영어(미국) 선택

  ![image-20200923092158146](C:\Users\whtpw\AppData\Roaming\Typora\typora-user-images\image-20200923092158146.png)
  
  
  
  - 영어를 위로 올려줌
  
  ![image-20200923092218048](C:\Users\whtpw\AppData\Roaming\Typora\typora-user-images\image-20200923092218048.png)



> 소프트웨어 설정 변경

- 소프트웨어 최소설치 클릭

![image-20200923092303071](C:\Users\whtpw\AppData\Roaming\Typora\typora-user-images\image-20200923092303071.png)



- 개발 및 창조를 위한 워크스테이션 클릭 

![image-20200923092359178](C:\Users\whtpw\AppData\Roaming\Typora\typora-user-images\image-20200923092359178.png)



> 네트워크 설정

- 네트워크 및 호스트명 선택

![image-20200923092437209](C:\Users\whtpw\AppData\Roaming\Typora\typora-user-images\image-20200923092437209.png)



- 이더넷 켬으로 설정 - 완료

![image-20200923092552714](C:\Users\whtpw\AppData\Roaming\Typora\typora-user-images\image-20200923092552714.png)



> 파티션 설정

- 자동 파티션 설정 선택 

![image-20200923092623690](C:\Users\whtpw\AppData\Roaming\Typora\typora-user-images\image-20200923092623690.png)



- 파티션을 설정합니다 선택 - 완료

![image-20200923092706391](C:\Users\whtpw\AppData\Roaming\Typora\typora-user-images\image-20200923092706391.png)



- 표준 파티션 선택 - + 버튼 클릭 

![image-20200923092802388](C:\Users\whtpw\AppData\Roaming\Typora\typora-user-images\image-20200923092802388.png)



- 마운트 지점 추가(swap)

![image-20200923092843802](C:\Users\whtpw\AppData\Roaming\Typora\typora-user-images\image-20200923092843802.png)



- 마운트 지점 추가(용량을 지정 안 하면 자동으로 용량 계산)

![image-20200923093013031](C:\Users\whtpw\AppData\Roaming\Typora\typora-user-images\image-20200923093013031.png)



- 완료 버튼 클릭 - 변경된 항목 저장

![image-20200923093041420](C:\Users\whtpw\AppData\Roaming\Typora\typora-user-images\image-20200923093041420.png)



- 설치 시작

![image-20200923093136037](C:\Users\whtpw\AppData\Roaming\Typora\typora-user-images\image-20200923093136037.png)



- 암호 클릭

![image-20200923093204801](C:\Users\whtpw\AppData\Roaming\Typora\typora-user-images\image-20200923093204801.png)



- 암호 bigdata

![image-20200923093251709](C:\Users\whtpw\AppData\Roaming\Typora\typora-user-images\image-20200923093251709.png)



- 사용자 생성

![image-20200923093310317](C:\Users\whtpw\AppData\Roaming\Typora\typora-user-images\image-20200923093310317.png)



- 전부 hadoop

![image-20200923093408286](C:\Users\whtpw\AppData\Roaming\Typora\typora-user-images\image-20200923093408286.png)



- 재부팅

![image-20200923094653710](C:\Users\whtpw\AppData\Roaming\Typora\typora-user-images\image-20200923094653710.png)



- 선택

![image-20200923094854818](C:\Users\whtpw\AppData\Roaming\Typora\typora-user-images\image-20200923094854818.png)



- 약관에 동의

![image-20200923094917762](C:\Users\whtpw\AppData\Roaming\Typora\typora-user-images\image-20200923094917762.png)



- 동의로 변경 - 설정완료 

![image-20200923094935405](C:\Users\whtpw\AppData\Roaming\Typora\typora-user-images\image-20200923094935405.png)



- 계정 접속

![image-20200923101017286](C:\Users\whtpw\AppData\Roaming\Typora\typora-user-images\image-20200923101017286.png)



- 계정 접속
  - pw : hadoop

![image-20200923101029279](C:\Users\whtpw\AppData\Roaming\Typora\typora-user-images\image-20200923101029279.png)



- 설정 모두 건너뛰기 

![image-20200923101102635](C:\Users\whtpw\AppData\Roaming\Typora\typora-user-images\image-20200923101102635.png)



![image-20200923101123175](C:\Users\whtpw\AppData\Roaming\Typora\typora-user-images\image-20200923101123175.png)



![image-20200923101141176](C:\Users\whtpw\AppData\Roaming\Typora\typora-user-images\image-20200923101141176.png)



![image-20200923101158988](C:\Users\whtpw\AppData\Roaming\Typora\typora-user-images\image-20200923101158988.png)



- centOS Linux 시작

![image-20200923101210525](C:\Users\whtpw\AppData\Roaming\Typora\typora-user-images\image-20200923101210525.png)



> 인터넷 연결 확인

- 유선 연결됨 확인

![image-20200923101259125](C:\Users\whtpw\AppData\Roaming\Typora\typora-user-images\image-20200923101259125.png)





- 프로그램 - Firefox 선택 

![image-20200923101348152](C:\Users\whtpw\AppData\Roaming\Typora\typora-user-images\image-20200923101348152.png)



![image-20200923101605010](C:\Users\whtpw\AppData\Roaming\Typora\typora-user-images\image-20200923101605010.png)



> 머신 끄기

- 컴퓨터 끄기 

![image-20200923101658432](C:\Users\whtpw\AppData\Roaming\Typora\typora-user-images\image-20200923101658432.png)



**3. 가상머신 복제하기**

> 네 개의 가상머신 생성

- C:\Users\whtpw\Documents\Virtual Machines 의 hadoop01 복사 
  - 02,03,04 만들기 

![image-20200923101918144](C:\Users\whtpw\AppData\Roaming\Typora\typora-user-images\image-20200923101918144.png)



![image-20200923102145412](C:\Users\whtpw\AppData\Roaming\Typora\typora-user-images\image-20200923102145412.png)



> 가상머신 띄우기

- open a vi

![image-20200923102456557](C:\Users\whtpw\AppData\Roaming\Typora\typora-user-images\image-20200923102456557.png)



![image-20200923102512507](C:\Users\whtpw\AppData\Roaming\Typora\typora-user-images\image-20200923102512507.png)



> 이름 변경

- edit virtual machine settings 선택 

![image-20200923102532544](C:\Users\whtpw\AppData\Roaming\Typora\typora-user-images\image-20200923102532544.png)



- options에서 이름 변경 

![image-20200923102613189](C:\Users\whtpw\AppData\Roaming\Typora\typora-user-images\image-20200923102613189.png)



- hadoop01 open

![image-20200923102814996](C:\Users\whtpw\AppData\Roaming\Typora\typora-user-images\image-20200923102814996.png)



- root 계정으로 로그인 

![image-20200923102911569](C:\Users\whtpw\AppData\Roaming\Typora\typora-user-images\image-20200923102911569.png)



- 비밀번호 bigdata

![image-20200923102927205](C:\Users\whtpw\AppData\Roaming\Typora\typora-user-images\image-20200923102927205.png)



- 터미널 열기
  - ifconfig 입력 

![image-20200923103341664](C:\Users\whtpw\AppData\Roaming\Typora\typora-user-images\image-20200923103341664.png)



> IP확인 

- 머신 한 대 더 띄우기 위해 workstation 실행
  - hadoop02 클릭 
  - 아이피를 새롭게 생성하기 위해 I Copied It을 선택해야함 

![image-20200923103533302](C:\Users\whtpw\AppData\Roaming\Typora\typora-user-images\image-20200923103533302.png)



- root로 로그인(pw: bigdata)

![image-20200923103713427](C:\Users\whtpw\AppData\Roaming\Typora\typora-user-images\image-20200923103713427.png)



- 터미널 열고 ifconfig 들어가서 hadoop01과 ip 다른지 확인

![image-20200923104200596](C:\Users\whtpw\AppData\Roaming\Typora\typora-user-images\image-20200923104200596.png)



- 같은 방식으로 hadoop03, hadoop04 생성

![image-20200923104319668](C:\Users\whtpw\AppData\Roaming\Typora\typora-user-images\image-20200923104319668.png)

![image-20200923104721384](C:\Users\whtpw\AppData\Roaming\Typora\typora-user-images\image-20200923104721384.png)



> 터미널에서 ssh 접속하기

- ssh 192.168.111.129 (hadoop2의 ip주소)
  - 현재 01,02의 host name이 같음 
  - exit로 close된 ip확인하면 hadoop2의 ip주소가 나오는 것을 확인(연결 성공)

![image-20200923111900927](C:\Users\whtpw\AppData\Roaming\Typora\typora-user-images\image-20200923111900927.png)



> 폴더 확인

- 내 폴더 클릭

![image-20200923114938635](C:\Users\whtpw\AppData\Roaming\Typora\typora-user-images\image-20200923114938635.png)

![image-20200923114910589](C:\Users\whtpw\AppData\Roaming\Typora\typora-user-images\image-20200923114910589.png)



- 폴더
  - etc: 설정정보가 저장되는 폴더 
  - home: hadoop
  - root: root의 home 디렉토리 (root는 관리자 계정)
  - usr 폴더: 다운로드와 같은 기능을 하는 폴더
  - lib: 라이브러리 저장 폴더
  - tmp: 임시 파일이 저장

![image-20200923114920355](C:\Users\whtpw\AppData\Roaming\Typora\typora-user-images\image-20200923114920355.png)



> 간단한 명령어

- [root@localhost ~]
  - root : 현재 계정
  - localhost : host명
  - ~ : 홈 디렉토리
- cd / : root 디렉토리로 이동

- su hadoop : 하둡 계정으로 들어감
- su - : 루트 계정으로 들어옴
- su - hadoop : 하둡 계정으로 들어감
- 루트 계정은 # 다른 계정은 $ 

![image-20200923131938205](C:\Users\whtpw\AppData\Roaming\Typora\typora-user-images\image-20200923131938205.png)



> 호스트명 변경 

- 호스트 네임 확인

![image-20200923133319630](C:\Users\whtpw\AppData\Roaming\Typora\typora-user-images\image-20200923133319630.png)



- 호스트명 변경

![image-20200923133403839](C:\Users\whtpw\AppData\Roaming\Typora\typora-user-images\image-20200923133403839.png)



- 터미널 껐다가 다시 키면 바뀐 호스트 네임이 나옴

![image-20200923133444861](C:\Users\whtpw\AppData\Roaming\Typora\typora-user-images\image-20200923133444861.png)



- hadoop02, 03, 04 모두 변경 
  - ssh 192.168.111.129
  - hostnamectl set-hostname hadoop02

![image-20200923133700048](C:\Users\whtpw\AppData\Roaming\Typora\typora-user-images\image-20200923133700048.png)



**4. 하둡 서버를 구축하기 위한 클러스터링 설정하기**

> 방화벽 해제하기

- 하둡은 분산 파일 시스템이다. 대용량의 데이터가 데이터노드 3대에 나누어 저장될 것이고 데이터노드 3대와 이를 관리하는 노드가 지속적으로 계속 통신을 해야하기 위해선 방화벽을 해제해야한다.



- 실행 중인 서비스 목록 확인

![image-20200923135043964](C:\Users\whtpw\AppData\Roaming\Typora\typora-user-images\image-20200923135043964.png)



- 방화벽 설정 확인 
  - ctrl+c 빠져나오기

![image-20200923135140896](C:\Users\whtpw\AppData\Roaming\Typora\typora-user-images\image-20200923135140896.png)



- 방화벽 실행 상태 확인

![image-20200923135308971](C:\Users\whtpw\AppData\Roaming\Typora\typora-user-images\image-20200923135308971.png)



- 방화벽 실행 중지 - reboot

![image-20200923140908724](C:\Users\whtpw\AppData\Roaming\Typora\typora-user-images\image-20200923140908724.png)

![image-20200923140920981](C:\Users\whtpw\AppData\Roaming\Typora\typora-user-images\image-20200923140920981.png)



- 현재 상태에서만 방화벽을 종료해놓은 것이라 reboot하고 다시 확인하면 방화벽이 꺼져있음

![image-20200923141119348](C:\Users\whtpw\AppData\Roaming\Typora\typora-user-images\image-20200923141119348.png)



- 방화벽이 다시 켜지지 않게 disable

![image-20200923141248486](C:\Users\whtpw\AppData\Roaming\Typora\typora-user-images\image-20200923141248486.png)



- reboot 후 다시 확인하면 방화면이 종료되어 있음을 확인

![image-20200923141434646](C:\Users\whtpw\AppData\Roaming\Typora\typora-user-images\image-20200923141434646.png)



- 02 방화벽 상태 확인 

![image-20200923141731815](C:\Users\whtpw\AppData\Roaming\Typora\typora-user-images\image-20200923141731815.png)



- 02, 03, 04 방화벽 해제

![image-20200923141913489](C:\Users\whtpw\AppData\Roaming\Typora\typora-user-images\image-20200923141913489.png)





> 도메인 네임 설정

- 내폴더

![image-20200923143105058](C:\Users\whtpw\AppData\Roaming\Typora\typora-user-images\image-20200923143105058.png)



- 다른위치 - 컴퓨터 

![image-20200923143134574](C:\Users\whtpw\AppData\Roaming\Typora\typora-user-images\image-20200923143134574.png)



- etc

![image-20200923143155454](C:\Users\whtpw\AppData\Roaming\Typora\typora-user-images\image-20200923143155454.png)



- etc 폴더의 hosts파일 - 텍스트 편집기로 열기

![image-20200923142610782](C:\Users\whtpw\AppData\Roaming\Typora\typora-user-images\image-20200923142610782.png)



- ip와 도메인 네임 입력 

![image-20200923142951373](C:\Users\whtpw\AppData\Roaming\Typora\typora-user-images\image-20200923142951373.png)



- 설정 확인

![image-20200923143345656](C:\Users\whtpw\AppData\Roaming\Typora\typora-user-images\image-20200923143345656.png)



- hadoop02, 03, 04 모두 설정하기 (설정파일 복사)
  - 머신끼리 복사 : scp 어떤 것 어디에 
  - 머신 안에서 복사 : cp

![image-20200923144056698](C:\Users\whtpw\AppData\Roaming\Typora\typora-user-images\image-20200923144056698.png)

![image-20200923144331486](C:\Users\whtpw\AppData\Roaming\Typora\typora-user-images\image-20200923144331486.png)



- 02 머신에 복사 확인

![image-20200923144307065](C:\Users\whtpw\AppData\Roaming\Typora\typora-user-images\image-20200923144307065.png)



> 암호통신 설정

- 하둡 계정 - 홈 디렉토리로 이동

![image-20200923145019993](C:\Users\whtpw\AppData\Roaming\Typora\typora-user-images\image-20200923145019993.png)

- 공개키 비공개키 생성
  - 내부에서 ssh 통신을 할 것인데 ssh 통신은 공개키 비공개키 암호 방식을 이용함
  - 마스터가 비공개키 슬레이브가 공개키

![image-20200923153608649](C:\Users\whtpw\AppData\Roaming\Typora\typora-user-images\image-20200923153608649.png)



- 숨겨진 키 확인 
  - .ssh : ssh가 숨겨져 있어서 .을 붙임 

![image-20200923154018001](C:\Users\whtpw\AppData\Roaming\Typora\typora-user-images\image-20200923154018001.png)



- 공개키 pub를 슬래이브(hadoop02)로 복사 (hadoop계정) - 하둡 홈디렉토리로 복사가 된다.
  - i 옵션을 통해 머신으로 공개키를 복사하겠다는 설정

![image-20200923154339757](C:\Users\whtpw\AppData\Roaming\Typora\typora-user-images\image-20200923154339757.png)

![image-20200923154410522](C:\Users\whtpw\AppData\Roaming\Typora\typora-user-images\image-20200923154410522.png)



- hadoop03, 04에도 공개키 복사

![image-20200923155424841](C:\Users\whtpw\AppData\Roaming\Typora\typora-user-images\image-20200923155424841.png)



- hadoop01머신에서 모든 머신에 접속할 때 암호 입력 없이 접속할 수 있다.
  - **hadoop01계정에서 공개키 비공개키를 만들고 공개키를 배포했기 때문에 hadoop01에서만 비밀번호 없이 접속할 수 있다.**

![image-20200923155614322](C:\Users\whtpw\AppData\Roaming\Typora\typora-user-images\image-20200923155614322.png)




